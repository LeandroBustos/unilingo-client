rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /usuarios/{usuarioId} {
      allow write: if request.auth != null &&
        request.resource.data.nombre is string &&
        request.resource.data.nombre.size() > 0 &&
        request.resource.data.correo is string &&
        request.resource.data.correo.matches("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$") &&
        request.resource.data.telefono is string &&
        request.resource.data.telefono.matches("^[0-9]{10}$");
    }
  }
}